<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>نظام النقاط</title>

<style>
body{
  background:#020617;
  color:white;
  font-family:Arial;
  padding:20px;
}
.card{
  background:#1e293b;
  padding:15px;
  margin:10px 0;
  border-radius:12px;
}
button{
  padding:8px 12px;
  margin:4px;
  border:none;
  border-radius:8px;
  font-size:15px;
  cursor:pointer;
}
.good{background:#22c55e;color:black;}
.bad{background:#ef4444;color:black;}
.score{
  text-align:center;
  font-size:28px;
  color:#facc15;
}
input{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:none;
}
.hidden{display:none;}
</style>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>

<body>

<div id="login" class="card">
  <h3>تسجيل الدخول</h3>
  <input id="user" placeholder="محمد الخير أو محمد عليان">
  <button class="good" onclick="login()">دخول</button>
</div>

<div id="app" class="hidden">

  <div class="score" id="score">0 نقطة</div>

  <div class="card">
    <h4>✅ الأعمال</h4>
    <button class="good" onclick="add(25)">صلاة (+25)</button>
    <button class="good" onclick="add(60)">دراسة (+60)</button>
    <button class="good" onclick="add(50)">رياضة (+50)</button>
    <button class="good" onclick="add(120)" id="readBtn">قراءة كتاب (+120)</button>
  </div>

  <div class="card">
    <h4>❌ أخطاء</h4>
    <button class="bad" onclick="add(-100)">هاتف (-100)</button>
    <button class="bad" onclick="add(-75)">نوم متأخر (-75)</button>
  </div>

  <button class="bad" onclick="logout()">خروج</button>

</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyB8VgV7TLZv5nYS7GQE1Z-oUg87BAnfrqk",
  authDomain: "points-system-fc43e.firebaseapp.com",
  databaseURL: "https://points-system-fc43e-default-rtdb.firebaseio.com/",
  projectId: "points-system-fc43e",
  storageBucket: "points-system-fc43e.firebasestorage.app",
  messagingSenderId: "753175770984",
  appId: "1:753175770984:web:6045f321d4a869f19008dd"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let currentUser = "";

function login(){
  const name = document.getElementById("user").value.trim();

  if(name!=="محمد الخير" && name!=="محمد عليان"){
    alert("اسم غير مسموح");
    return;
  }

  currentUser = name;

  document.getElementById("login").classList.add("hidden");
  document.getElementById("app").classList.remove("hidden");

  if(name==="محمد الخير"){
    document.getElementById("readBtn").style.display="none";
  }

  loadScore();
}

function logout(){
  location.reload();
}

function loadScore(){
  db.ref("users/"+currentUser).on("value", snap=>{
    let val = snap.val();
    if(val===null){
      db.ref("users/"+currentUser).set(0);
      val = 0;
    }
    document.getElementById("score").innerText = val+" نقطة";
  });
}

function add(val){
  db.ref("users/"+currentUser).once("value", snap=>{
    let current = snap.val() || 0;
    db.ref("users/"+currentUser).set(current + val);
  });
}
</script>

</body>
</html>
